<p id="notice"><%= notice %></p>


<h3><%# link_to  @list.name, properties_path(@list) %></h3>

<h3>invite user</h3>
<%# simple_form_for(:user, url: invite_list_path,
                                html: { class: 'mezbahinvite'}) do |f| %>
    <%# f.input :email, placeholder: 'Email', label: false %>
    <%# f.button :submit, 'Invite User', class: 'btn-primary' %>
<%# end %>



<%= form_for @invite , :url => invites_path do |f| %>
    <%= f.hidden_field :list_id, :value => @invite.list_id %>
    <%= f.label :email %>
    <%= f.email_field :email %>
    <%= f.submit 'Send Invite', class: 'btn-primary' %>
<% end %>




<h2>In this list  <%= @members.size %>Members</h2>
<% @members.each do |member| %>
    <ul>
      <li><%= member.email %></li>
    </ul>
<% end %>


<% if current_user.id == @list.owner_id %>
<%= link_to 'Edit', edit_list_path(@list) %> |
<% end %>
<%= link_to 'Back', lists_path %>



<script src="//maps.google.com/maps/api/js?v=3.18&sensor=false&client=&key=&libraries=geometry&language=&hl=&region="></script>
<script src="//google-maps-utility-library-v3.googlecode.com/svn/tags/markerclustererplus/2.0.14/src/markerclusterer_packed.js"></script>
<script src='//google-maps-utility-library-v3.googlecode.com/svn/tags/infobox/1.1.9/src/infobox_packed.js' type='text/javascript'></script> <!-- only if you need custom infoboxes -->


<p id="notice"><%= notice %></p>


<%# form_for @invite , :url => invites_path do |f| %>
<%# f.hidden_field :list_id, :value => @invite.list_id %>
<%# f.label :email %>
<%# f.email_field :email %>
<%# f.submit 'Send Invite', class: 'btn-primary' %>
<%# end %>

<% if @properties.present? %>

    <h1>All Properties</h1>
    <div style='width: 800px;'>
      <div id="map" style='width: 600px; height: 400px;'></div>
    </div>

    <script type = "text/javascript">
        handler = Gmaps.build('Google');
        handler.buildMap({ provider: {}, internal: {id: 'map'}}, function(){
            markers = handler.addMarkers(<%=raw @hash.to_json %>);
            handler.bounds.extendWith(markers);
            handler.fitMapToBounds();
        });
    </script>

<% end %>
<table>


  <tbody>
  <% @properties.each do |property| %>
      <tr>

        <td><%= property.street_address %></td>
        <td><%= property.city %></td>
        <td><%= property.state %></td>
        <td><%= property.url %></td>
        <td><%= property.photo_url %></td>
        <td><%= property.description %></td>
        <td><%= property.tags %></td>
        <td><%= property.bedroom %></td>
        <td><%= property.bathroom %></td>
        <td><%= property.price %></td>
        <td><%= property.status %></td>
        <td><%=  link_to "show", property_path(:id => property.id) %></td>

            <td><%=  link_to "Edit", edit_property_path(:id => property.id) %></td>
            <td><%=  link_to "Delete", property_path(:id => property.id) ,method: :delete, data: { confirm: "Are you sure?" } %></td>


      </tr>


  <% end %>
  </tbody>
</table>

<br>
<%= link_to 'Back', lists_path %>

<h5>Add Property</h5>
<%= form_for(@list, url: add_property_list_path,  :method => :POST) do |f| %>
    <%= f.collection_check_boxes(:property_ids, @user_all_properties, :id, :street_address) %>
    <%= f.submit "Add Property" %>
<% end %>





<div class="event">
  <p><%= pluralize(@list.comment_threads.size, "comment") %> in <strong><%= @list.name %></strong>  </p>
</div>

<div class="comments">
  <h2>Comments</h2>
  <%= render :partial => 'comments/form', :locals => { :comment => @new_comment } %>
  <%= render :partial => 'comments/comment', :collection => @comments, :as => :comment %>
</div>

<%= render 'shared/actions', resource: @list %>
<span class="like-count"><%= pluralize(@list.cached_votes_up, 'like') %></span>